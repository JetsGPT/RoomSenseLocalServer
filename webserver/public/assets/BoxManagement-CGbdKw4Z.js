import{c as C,j as e,f as E,W as R,r as a,Y as v,Z as P,m as N,C as k,o as D,p as F,_ as M,B as y,q as T,L as w,O as $,P as z,$ as A}from"./index-D6WdRWCL.js";import{R as H}from"./refresh-cw-C9S8LOyJ.js";import{T as W,P as O}from"./trash-2-91eka599.js";/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],b=C("search",U);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],q=C("wifi-off",V);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],Z=C("wifi",Y),G=R("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500/10 text-green-700 dark:text-green-400"}},defaultVariants:{variant:"default"}});function B({className:r,variant:o,...l}){return e.jsx("div",{className:E(G({variant:o}),r),...l})}const J=()=>{const[r,o]=a.useState([]);return{toast:a.useCallback(({title:d,description:m,variant:h="default",duration:u=3e3})=>{const f=Date.now(),g={id:f,title:d,description:m,variant:h};o(x=>[...x,g]),setTimeout(()=>{o(x=>x.filter(p=>p.id!==f))},u),console.log(`[Toast ${h}] ${d}: ${m}`)},[]),toasts:r}},ee=()=>{const[r,o]=a.useState([]),[l,d]=a.useState([]),[m,h]=a.useState(!1),[u,f]=a.useState(!0),[g,x]=a.useState(new Set),[p,S]=a.useState(new Set),{toast:i}=J();a.useEffect(()=>{j()},[]);const j=async()=>{f(!0);try{const s=await v.getActiveConnections();o(s)}catch(s){console.error("Failed to fetch active connections:",s),i({title:"Error",description:"Failed to load active connections",variant:"destructive"})}finally{f(!1)}},_=async()=>{h(!0),d([]);try{const s=await v.scanDevices();d(s),i({title:"Scan Complete",description:`Found ${s.length} device(s)`})}catch(s){console.error("Scan failed:",s),i({title:"Scan Failed",description:s.message||"Failed to scan for devices",variant:"destructive"})}finally{h(!1)}},I=async(s,c)=>{x(t=>new Set(t).add(s));try{await v.connectDevice(s,c),i({title:"Connected",description:`Successfully connected to ${c||s}`}),await j(),d(t=>t.filter(n=>n.address!==s))}catch(t){console.error("Connection failed:",t),i({title:"Connection Failed",description:t.message||"Failed to connect to device",variant:"destructive"})}finally{x(t=>{const n=new Set(t);return n.delete(s),n})}},L=async(s,c)=>{S(t=>new Set(t).add(s));try{await v.disconnectDevice(s),i({title:"Disconnected",description:`Disconnected from ${c||s}`}),await j()}catch(t){console.error("Disconnect failed:",t),i({title:"Disconnect Failed",description:t.message||"Failed to disconnect from device",variant:"destructive"})}finally{S(t=>{const n=new Set(t);return n.delete(s),n})}};return e.jsx("div",{className:"min-h-screen bg-background p-4 sm:p-6",children:e.jsx(P,{children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 sm:space-y-8",children:[e.jsxs(N.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-2",children:"My Boxes"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Manage your RoomSense slave boxes and BLE connections"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(k,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),"Active Connections"]}),e.jsx(M,{children:"Currently connected slave boxes"})]}),e.jsx(y,{variant:"outline",size:"icon",onClick:j,disabled:u,children:e.jsx(H,{className:`h-4 w-4 ${u?"animate-spin":""}`})})]})}),e.jsx(T,{children:u?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(w,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):r.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(q,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"No active connections"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Scan for devices to connect"})]}):e.jsx($,{className:"space-y-3",children:r.map((s,c)=>e.jsx(z,{index:c,children:e.jsxs(N.div,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-3 sm:p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors gap-3 sm:gap-0",whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsx("div",{className:"p-2 rounded-full bg-green-500/10 flex-shrink-0",children:e.jsx(A,{className:"h-5 w-5 text-green-500"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium truncate",children:s.name||"Unknown Device"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",children:s.address})]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto justify-end",children:[e.jsx(B,{variant:"success",className:"bg-green-500/10 text-green-700 dark:text-green-400 whitespace-nowrap",children:"Connected"}),e.jsx(y,{variant:"destructive",size:"icon",onClick:()=>L(s.address,s.name),disabled:p.has(s.address),className:"flex-shrink-0",children:p.has(s.address)?e.jsx(w,{className:"h-4 w-4 animate-spin"}):e.jsx(W,{className:"h-4 w-4"})})]})]})},s.address))})})]}),e.jsxs(k,{children:[e.jsxs(D,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5"}),"Scan for Devices"]}),e.jsx(M,{children:"Find nearby RoomSense slave boxes"})]}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(y,{onClick:_,disabled:m,className:"w-full",size:"lg",children:m?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"mr-2 h-5 w-5 animate-spin"}),"Scanning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"mr-2 h-5 w-5"}),"Start Scan"]})}),l.length>0&&e.jsx($,{className:"space-y-3 mt-4",children:l.map((s,c)=>{const t=r.some(n=>n.address===s.address);return e.jsx(z,{index:c,children:e.jsxs(N.div,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-3 sm:p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors gap-3 sm:gap-0",whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsx("div",{className:"p-2 rounded-full bg-blue-500/10 flex-shrink-0",children:e.jsx(A,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium truncate",children:s.name||"Unknown Device"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",children:s.address})]})]}),t?e.jsx(B,{variant:"secondary",className:"whitespace-nowrap",children:"Already Connected"}):e.jsx(y,{variant:"default",size:"sm",onClick:()=>I(s.address,s.name),disabled:g.has(s.address),className:"w-full sm:w-auto flex-shrink-0",children:g.has(s.address)?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"mr-2 h-4 w-4 animate-spin"}),"Connecting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"Connect"]})})]})},s.address)})}),!m&&l.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(b,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No devices scanned yet"}),e.jsx("p",{className:"text-sm mt-1",children:'Click "Start Scan" to find devices'})]})]})})]})]})]})})})};export{ee as default};
