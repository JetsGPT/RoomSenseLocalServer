import{c as j,j as e,J as L,ag as E,F as R,r as l,ah as H,ai as P,m as f,Q as k,U as C,V as S,aj as D,B as d,a5 as U,W as F,L as m,ab as M,ac as z,ak as B,al as g}from "./index-BqfF2MFw.js";import{T as V,P as W}from "./trash-2-OWe3h-39.js";/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],p=j("search",J);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Q=j("wifi-off",O);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],G=j("wifi",q),K=E("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500/10 text-green-700 dark:text-green-400"}},defaultVariants:{variant:"default"}});function T({className:i,variant:o,...c}){return e.jsx("div",{className:L(K({variant:o}),i),...c})}const Z=()=>{const{activeConnections:i,loading:o,refreshConnections:c}=R(),[x,h]=l.useState([]),[u,y]=l.useState(!1),[v,w]=l.useState(new Set),[N,b]=l.useState(new Set),{toast:r}=H();l.useEffect(()=>{c(!0)},[c]);const _=()=>c(),$=async()=>{y(!0),h([]);try{const s=await g.scanDevices();h(s),r({title:"Scan Complete",description:`Found ${s.length} device(s)`})}catch(s){console.error("Scan failed:",s),r({title:"Scan Failed",description:s.message||"Failed to scan for devices",variant:"destructive"})}finally{y(!1)}},A=async(s,t)=>{w(a=>new Set(a).add(s));try{await g.connectDevice(s,t),r({title:"Connected",description:`Successfully connected to ${t||s}`}),await c(),h(a=>a.filter(n=>n.address!==s))}catch(a){console.error("Connection failed:",a),r({title:"Connection Failed",description:a.message||"Failed to connect to device",variant:"destructive"})}finally{w(a=>{const n=new Set(a);return n.delete(s),n})}},I=async(s,t)=>{b(a=>new Set(a).add(s));try{await g.disconnectDevice(s),r({title:"Disconnected",description:`Disconnected from ${t||s}`}),await c()}catch(a){console.error("Disconnect failed:",a),r({title:"Disconnect Failed",description:a.message||"Failed to disconnect from device",variant:"destructive"})}finally{b(a=>{const n=new Set(a);return n.delete(s),n})}};return e.jsx("div",{className:"min-h-screen bg-background p-4 sm:p-6",children:e.jsx(P,{children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 sm:space-y-8",children:[e.jsxs(f.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-2",children:"My Boxes"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Manage your RoomSense slave boxes and BLE connections"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(k,{children:[e.jsx(C,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Active Connections"]}),e.jsx(D,{children:"Currently connected slave boxes"})]}),e.jsx(d,{variant:"outline",size:"icon",onClick:_,disabled:o,children:e.jsx(U,{className:`h-4 w-4 ${o?"animate-spin":""}`})})]})}),e.jsx(F,{children:o?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(m,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Q,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"No active connections"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Scan for devices to connect"})]}):e.jsx(M,{className:"space-y-3",children:i.map((s,t)=>e.jsx(z,{index:t,children:e.jsxs(f.div,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-3 sm:p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors gap-3 sm:gap-0",whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsx("div",{className:"p-2 rounded-full bg-green-500/10 flex-shrink-0",children:e.jsx(B,{className:"h-5 w-5 text-green-500"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium truncate",children:s.name||"Unknown Device"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",children:s.address})]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto justify-end",children:[e.jsx(T,{variant:"success",className:"bg-green-500/10 text-green-700 dark:text-green-400 whitespace-nowrap",children:"Connected"}),e.jsx(d,{variant:"destructive",size:"icon",onClick:()=>I(s.address,s.name),disabled:N.has(s.address),className:"flex-shrink-0",children:N.has(s.address)?e.jsx(m,{className:"h-4 w-4 animate-spin"}):e.jsx(V,{className:"h-4 w-4"})})]})]})},s.address))})})]}),e.jsxs(k,{children:[e.jsxs(C,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5"}),"Scan for Devices"]}),e.jsx(D,{children:"Find nearby RoomSense slave boxes"})]}),e.jsx(F,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(d,{onClick:$,disabled:u,className:"w-full",size:"lg",children:u?e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"mr-2 h-5 w-5 animate-spin"}),"Scanning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"mr-2 h-5 w-5"}),"Start Scan"]})}),x.length>0&&e.jsx(M,{className:"space-y-3 mt-4",children:x.map((s,t)=>{const a=i.some(n=>n.address===s.address);return e.jsx(z,{index:t,children:e.jsxs(f.div,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-3 sm:p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors gap-3 sm:gap-0",whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsx("div",{className:"p-2 rounded-full bg-blue-500/10 flex-shrink-0",children:e.jsx(B,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium truncate",children:s.name||"Unknown Device"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",children:s.address})]})]}),a?e.jsx(T,{variant:"secondary",className:"whitespace-nowrap",children:"Already Connected"}):e.jsx(d,{variant:"default",size:"sm",onClick:()=>A(s.address,s.name),disabled:v.has(s.address),className:"w-full sm:w-auto flex-shrink-0",children:v.has(s.address)?e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"mr-2 h-4 w-4 animate-spin"}),"Connecting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Connect"]})})]})},s.address)})}),!u&&x.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(p,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No devices scanned yet"}),e.jsx("p",{className:"text-sm mt-1",children:'Click "Start Scan" to find devices'})]})]})})]})]})]})})})};export{Z as default};
